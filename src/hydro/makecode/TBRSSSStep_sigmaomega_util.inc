{
//Reorder lines in the actual evaluations order
sg[4]=2*DIuJ[0][0]-(2*theta*(1+pow(u[1],2)))/3.+2*a[1]*u[1];
sg[5]=DIuJ[0][1]+DIuJ[1][0]+a[2]*u[1]+a[1]*u[2]-(2*theta*u[1]*u[2])/3.;
sg[6]=DIuJ[0][2]+DIuJ[2][0]+a[3]*u[1]+a[1]*u[3]-(2*theta*u[1]*u[3])/3.;
sg[7]=2*DIuJ[1][1]-(2*theta*(1+pow(u[2],2)))/3.+2*a[2]*u[2];
sg[8]=DIuJ[1][2]+DIuJ[2][1]+a[3]*u[2]+a[2]*u[3]-(2*theta*u[2]*u[3])/3.;
sg[9]=2*DIuJ[2][2]-(2*theta*(1+pow(u[3],2)))/3.+2*a[3]*u[3];
sg[0]=sg[4]+sg[7]+sg[9];
sg[1]=(sg[4]*u[1]+sg[5]*u[2]+sg[6]*u[3])/u[0];
sg[2]=(sg[5]*u[1]+sg[7]*u[2]+sg[8]*u[3])/u[0];
sg[3]=(sg[6]*u[1]+sg[8]*u[2]+sg[9]*u[3])/u[0];
om[3]=(DIuJ[0][1]-DIuJ[1][0]+a[2]*u[1]-a[1]*u[2])/2.;
om[4]=(DIuJ[0][2]-DIuJ[2][0]+a[3]*u[1]-a[1]*u[3])/2.;
om[5]=(DIuJ[1][2]-DIuJ[2][1]+a[3]*u[2]-a[2]*u[3])/2.;
om[0]=(om[3]*u[2]+om[4]*u[3])/u[0];
om[1]=(-(om[3]*u[1])+om[5]*u[3])/u[0];
om[2]=-((om[4]*u[1]+om[5]*u[2])/u[0]);
}
